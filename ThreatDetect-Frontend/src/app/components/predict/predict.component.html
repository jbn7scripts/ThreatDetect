<div class="predict-bg"></div>
<div class="predict-root">
  <div class="container my-5 py-5">
    <div class="auth-container">
      <h2 class="text-center mb-4">Packet Details Analysis</h2>
      <p class="text-center text-muted mb-5">Please provide the network packet details for analysis</p>

      <form (ngSubmit)="onSubmit()" class="auth-form">
        <!-- Row 1 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Duration</label>
            <input
              type="number"
              [(ngModel)]="formData.duration"
              name="duration"
              class="form-control"
              placeholder="Enter duration"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Protocol Type</label>
            <select
              class="form-select"
              [(ngModel)]="formData.protocol_type"
              name="protocol_type"
              required
            >
              <option [value]="1">TCP</option>
              <option [value]="0">ICMP</option>
              <option [value]="2">UDP</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Service Type</label>
            <select
              class="form-select"
              [(ngModel)]="formData.service"
              name="service"
              required
            >
              <option [value]="0">IRC</option>
              <option [value]="1">X11</option>
              <option [value]="2">Z39_50</option>
              <option [value]="3">AOL</option>
              <option [value]="4">AUTH</option>
              <!-- etc... replicate all the service options from your snippet -->
            </select>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Packet Flag</label>
            <select
              class="form-select"
              [(ngModel)]="formData.flag"
              name="flag"
              required
            >
              <option [value]="0">OTH</option>
              <option [value]="1">REJ</option>
              <option [value]="2">RSTO</option>
              <option [value]="3">RSTOS0</option>
              <option [value]="4">RSTR</option>
              <option [value]="5">S0</option>
              <option [value]="6">S1</option>
              <option [value]="7">S2</option>
              <option [value]="8">S3</option>
              <option [value]="9">SF</option>
              <option [value]="10">SH</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Source Bytes</label>
            <input
              type="number"
              [(ngModel)]="formData.src_bytes"
              name="src_bytes"
              class="form-control"
              placeholder="Enter source bytes"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Destination Bytes</label>
            <input
              type="number"
              [(ngModel)]="formData.dst_bytes"
              name="dst_bytes"
              class="form-control"
              placeholder="Enter destination bytes"
              required
            />
          </div>
        </div>

        <!-- Row 3 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Packet Land</label>
            <input
              type="number"
              [(ngModel)]="formData.land"
              name="land"
              class="form-control"
              placeholder="0 or 1"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Wrong Fragment</label>
            <input
              type="number"
              [(ngModel)]="formData.wrong_fragment"
              name="wrong_fragment"
              class="form-control"
              placeholder="0, 1, or 3"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Urgent</label>
            <input
              type="number"
              [(ngModel)]="formData.urgent"
              name="urgent"
              class="form-control"
              placeholder="0-3"
              required
            />
          </div>
        </div>

        <!-- Row 4 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Hot</label>
            <input
              type="number"
              [(ngModel)]="formData.hot"
              name="hot"
              class="form-control"
              placeholder="0-40"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Failed Logins</label>
            <input
              type="number"
              [(ngModel)]="formData.num_failed_logins"
              name="num_failed_logins"
              class="form-control"
              placeholder="Enter number"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Logged In</label>
            <input
              type="number"
              [(ngModel)]="formData.logged_in"
              name="logged_in"
              class="form-control"
              placeholder="0 or 1"
              required
            />
          </div>
        </div>

        <!-- Row 5 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Num Compromised</label>
            <input
              type="number"
              [(ngModel)]="formData.num_compromised"
              name="num_compromised"
              class="form-control"
              placeholder="Enter number"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Root Shell</label>
            <input
              type="number"
              [(ngModel)]="formData.root_shell"
              name="root_shell"
              class="form-control"
              placeholder="0 or 1"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">SU Attempted</label>
            <input
              type="number"
              [(ngModel)]="formData.su_attempted"
              name="su_attempted"
              class="form-control"
              placeholder="0-2"
              required
            />
          </div>
        </div>

        <!-- Row 6 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">File Creations</label>
            <input
              type="number"
              [(ngModel)]="formData.num_file_creations"
              name="num_file_creations"
              class="form-control"
              placeholder="0-100"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Num Shells</label>
            <input
              type="number"
              [(ngModel)]="formData.num_shells"
              name="num_shells"
              class="form-control"
              placeholder="0-5"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Access Files</label>
            <input
              type="number"
              [(ngModel)]="formData.num_access_files"
              name="num_access_files"
              class="form-control"
              placeholder="0-10"
              required
            />
          </div>
        </div>

        <!-- Row 7 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Outbound Cmds</label>
            <input
              type="number"
              [(ngModel)]="formData.num_outbound_cmds"
              name="num_outbound_cmds"
              class="form-control"
              placeholder="0"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Host Login</label>
            <input
              type="number"
              [(ngModel)]="formData.is_host_login"
              name="is_host_login"
              class="form-control"
              placeholder="0 or 1"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Guest Login</label>
            <input
              type="number"
              [(ngModel)]="formData.is_guest_login"
              name="is_guest_login"
              class="form-control"
              placeholder="0 or 1"
              required
            />
          </div>
        </div>

        <!-- Row 8 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Count</label>
            <input
              type="number"
              [(ngModel)]="formData.count"
              name="count"
              class="form-control"
              placeholder="Enter count"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Srv Count</label>
            <input
              type="number"
              [(ngModel)]="formData.srv_count"
              name="srv_count"
              class="form-control"
              placeholder="Enter srv count"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Serror Rate</label>
            <input
              type="number"
              step="0.01"
              [(ngModel)]="formData.serror_rate"
              name="serror_rate"
              class="form-control"
              placeholder="0.01-1.00"
              required
            />
          </div>
        </div>

        <!-- Row 9 -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <label class="form-label">Rerror Rate</label>
            <input
              type="number"
              step="0.01"
              [(ngModel)]="formData.rerror_rate"
              name="rerror_rate"
              class="form-control"
              placeholder="0.01-1.00"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Same Srv Rate</label>
            <input
              type="number"
              step="0.01"
              [(ngModel)]="formData.same_srv_rate"
              name="same_srv_rate"
              class="form-control"
              placeholder="0.01-1.00"
              required
            />
          </div>
          <div class="col-md-4">
            <label class="form-label">Diff Srv Rate</label>
            <input
              type="number"
              step="0.01"
              [(ngModel)]="formData.diff_srv_rate"
              name="diff_srv_rate"
              class="form-control"
              placeholder="0.01-1.00"
              required
            />
          </div>
        </div>

        <!-- Submit Button -->
        <div class="text-center my-5">
          <button type="submit" class="btn btn-cyber w-50">
            <i class="fas fa-shield-alt me-2"></i>Analyse Packet
          </button>
        </div>
      </form>

      <!-- If we have a result -->
      <div class="text-center mt-5" *ngIf="predictionResult">
        <h4 class="mb-3">Analysis Result</h4>
        <div class="alert alert-info d-inline-flex align-items-center">
          <i class="fas fa-info-circle fa-2x me-3"></i>
          <h5 class="m-0">{{ predictionResult }}</h5>
        </div>
      </div>
    </div>
  </div>
</div>
